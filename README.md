See http://techblog.lol/post/walkthrough-exploiting-bugs-to-gain-code-execution/